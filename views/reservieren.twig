{% extends "layout.twig" %}

        {% block body %}
			  {{ parent() }}
			  
			  <h2>Reservierungen am {{ datum }}</h2>
			  
		{% if datum %}
			
			<table>
				<th>
					
					
					{% for p in platz %}
						<td class="tdown">Platz {{ p.PlatzNr }}</td>
						<td></td>
					{% endfor %}			
					
				</th>
				
				{% for z in zeit.OffenVon..zeit.OffenBis %}
					<tr>
						<td>{{ z }} Uhr</td>
						{% for p in platz %}
							<td 
							{% if p.Gesperrt %}
								{% for key, value in farben %}
									{% if key == "zu" %} style="background-color:{{ value }}" {% endif %}
								{% endfor %} >
								{{ p.Kommentar }}
								{% set closed = 1 %}
							{% else %}
								{% set voll = 0 %}
								{% for res in reservierungen %}
									{% if res.fk_Platz_ID == p.Platz_ID and z >= res.ReservierungVon and z < res.ReservierungBis %}
										{% for key, value in farben %}
											{% if key == "besetzt" %} style="background-color:{{ value }}" {% endif %}
										{% endfor %} >
										{% if benutzerrecht %}
											 {% for m in mitglieder %}
												{% if res.fk_Mitglied_ID == m.Mitglied_ID %}
												 	{{ m.Vorname }} {{ m.Nachname }}
												{% endif %}
											 {% endfor %}
										{% else %}	
											reserviert
										{% endif %}
										{% set voll = 1 %}
									{% endif %}
								{% endfor %}
								{% if voll == 0 %}
									{% for key, value in farben %}
										{% if key == "frei" %} style="background-color:{{ value }}" {% endif %}
									{% endfor %} >
									frei
									</td>
									<td>
										<form id= "reservieren" method="post" action="../php/resformular.php">
											<input type="hidden" name="pid" value="{{ p.Platz_ID }}">
											<input type="hidden" name="pnr" value="{{ p.PlatzNr }}">
											<input type="hidden" name="zeit" value="{{ z }}">
											<input type="hidden" name="geklickt">
											<button type="submit" class="ym-button ym-spark">reservieren</button>
										</form>
									</td>
								{% else %}
									</td>
								{% endif %}
							{% endif %}
							
						
						{% endfor %}
						
					</tr>
					
				{% endfor %}
				
				
				
				
				
				

			</table>
				{% if closed == 1 %}
					<p class="box error">
						Es ist aktuell keine Reservierung möglich, da der gewählte Platz gesperrt ist!
					</p>
				{% endif %}
			
			
			{% else %}
				
				
			{% endif %}
			
			
			
			
	
		{% endblock %}
